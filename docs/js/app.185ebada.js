(function(e){function t(t){for(var r,a,s=t[0],c=t[1],u=t[2],d=0,m=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&m.push(o[a][0]),o[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(m.length)m.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={app:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("header",[n("NavBar")],1),n("div",{staticClass:"mt-3"},[n("router-view")],1)])},i=[],a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"info"}},[n("b-navbar-brand",{attrs:{href:"#"}},[e._v("TypingApp")]),n("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),n("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[n("b-navbar-nav",[e.isAutentificated?e._e():[n("b-nav-item",{attrs:{to:"/about"}},[e._v("About")]),n("b-nav-item",{attrs:{to:"/signup"}},[e._v("Sign up")]),n("b-nav-item",{attrs:{to:"/login"}},[e._v("Login")])],e.isAutentificated?[n("b-nav-item",{attrs:{to:"/"}},[e._v("Home")]),n("b-nav-item",{attrs:{to:"/edit"}},[e._v("Edit")]),n("b-nav-item",{attrs:{to:"/about"}},[e._v("About")]),n("b-nav-item",{staticClass:"logout",on:{click:function(t){return e.logout()}}},[e._v("Logout")])]:e._e()],2)],1)],1)],1)},s=[],c={computed:{isAutentificated:function(){return null!==this.$store.getters.idToken}},methods:{logout:function(){this.$store.dispatch("logout")}}},u=c,l=(n("71eb"),n("2877")),d=Object(l["a"])(u,a,s,!1,null,"4c64e0d4",null),m=d.exports,f={components:{NavBar:m}},p=f,h=(n("5c0b"),Object(l["a"])(p,o,i,!1,null,null,null)),b=h.exports,v=n("8c4f"),g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-container",[r("img",{attrs:{alt:"Vue logo",src:n("cf05")}}),r("GameDisplay",{attrs:{msg:"Welcome to my typing App",words:e.words}})],1)},w=[],k=n("5530"),_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isActive?[n("h2",{staticClass:"quiz"},[e._v(e._s(e.quiz))]),n("div",[e._v(" score: "),n("span",[e._v(e._s(e.score))]),e._v(" miss: "),n("span",[e._v(e._s(e.miss))]),e._v(" time left: "),n("span",[e._v(e._s(e.timer))])])]:[n("h2",[e._v(e._s(e.msg))]),n("h3",[n("b-badge",{attrs:{variant:"info"}},[e._v("Press Space to Start!")])],1)]],2)},T=[],y=(n("99af"),n("b680"),1e4),x="0.00",I=5e3,j={name:"GameDisplay",props:{msg:String,words:Array},data:function(){return{isActive:!1,quiz:"quiz",score:0,miss:0,loc:0,timer:x,timeLimit:y,bonusTime:I,startTime:"",isClear:!1}},mounted:function(){var e=this;window.addEventListener("keydown",(function(t){if(32===t.keyCode){if(e.isActive)return;e.startGame()}}))},methods:{init:function(){this.loc=0,this.score=0,this.miss=0},startGame:function(){this.init(),this.isActive=!0,this.startTime=Date.now(),this.updateTimer(),this.makeQuiz(),this.typeWord()},updateTimer:function(){var e,t=this;e=this.timeLimit-(Date.now()-this.startTime),this.timer=(e/1e3).toFixed(2);var n=setTimeout((function(){t.updateTimer()}),10);e<0&&(clearTimeout(n),this.timer="0.00",setTimeout((function(){t.showResult(),t.retry()}),100))},addBonusTime:function(){this.timeLimit=this.timeLimit+this.bonusTime},showResult:function(){var e=this.score+this.miss===0?0:this.score/(this.score+this.miss)*100,t="Score: ".concat(this.score,", Miss: ").concat(this.miss,", Accuary :").concat(e.toFixed(2),"%");alert(t)},retry:function(){var e="Try again?",t=confirm(e);t&&(this.init(),this.isActive=!1,location.reload())},makeQuiz:function(){var e=Math.floor(Math.random()*this.words.length);return this.quiz=this.words[e].document.fields.sentence.stringValue,this.quiz},updateTarget:function(){for(var e="",t=0;t<this.loc;t++)e+="_";this.quiz=e+this.quiz.substring(this.loc)},typeWord:function(){var e=this;this.isActive&&window.addEventListener("keydown",(function(t){e.checkAnswer(t)}))},checkAnswer:function(e){e.key===this.quiz[this.loc]?(this.loc++,this.isClear=!1,this.loc===this.quiz.length&&(this.makeQuiz(),this.loc=0,this.isClear=!0,this.addBonusTime()),this.updateTarget(),this.score++):this.miss++}}},O=j,A=(n("b047"),Object(l["a"])(O,_,T,!1,null,"33356712",null)),S=A.exports,E=n("2f62"),U={name:"Home",components:{GameDisplay:S},data:function(){return{}},created:function(){this.$store.dispatch("getUserItems",this.idToken)},computed:Object(k["a"])({},Object(E["b"])(["idToken","words","currentUser"]))},$=U,z=Object(l["a"])($,g,w,!1,null,null,null),C=z.exports,M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",[n("h2",[e._v("This is an about page")])])},D=[],L={name:"About"},W=L,q=Object(l["a"])(W,M,D,!1,null,null,null),P=q.exports,R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",[n("h2",[e._v("User Profile")]),n("p",[e._v("user_id: "+e._s(e.currentUser.id))]),n("p",[e._v("user_email: "+e._s(e.currentUser.email))]),n("hr"),n("h2",[e._v("this is an edit page")]),n("p",[e._v("You can edit your words and sentences here.")]),n("add-button"),n("add-modal"),n("items-table")],1)},G=[],B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"text-right mb-3"},[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-add-form",modifiers:{"modal-add-form":!0}}],staticClass:"h2 mb-0",attrs:{variant:"outline-info"}},[n("b-icon-plus-circle")],1)],1)},V=[],Q={name:"AddButton"},N=Q,X=Object(l["a"])(N,B,V,!1,null,null,null),F=X.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{id:"modal-add-form",title:"Add new word or sentence"},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var r=t.cancel,o=t.hide;return[n("b-button",{attrs:{size:"sm",variant:"outline-info"},on:{click:function(t){e.addWord(),o()}}},[e._v(" 追加 ")]),n("b-button",{attrs:{size:"sm",variant:"outline-danger"},on:{click:function(e){return r()}}},[e._v(" キャンセル ")])]}}])},[n("b-input",{model:{value:e.newSentence,callback:function(t){e.newSentence=t},expression:"newSentence"}})],1)],1)},Y=[],J=n("bc3a"),K=n.n(J),Z={computed:Object(k["a"])({},Object(E["b"])(["idToken","words","currentUser"])),data:function(){return{newSentence:""}},methods:{addWord:function(){var e=this,t={fields:{sentence:{stringValue:this.newSentence},userId:{stringValue:this.currentUser.id}}},n="projects/typing-app-f08b8/databases/(default)/documents/words/";K.a.post(n,t,{headers:{Authorization:"Bearer ".concat(this.idToken)}}).then((function(t){console.log(t),e.$store.dispatch("getAllData",e.idToken)})).catch((function(e){console.log(e)}))}}},ee=Z,te=Object(l["a"])(ee,H,Y,!1,null,null,null),ne=te.exports,re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("table",{staticClass:"table"},[e._m(0),n("tbody",e._l(e.words,(function(t,r){return n("tr",{key:t.name},[n("td",[e._v(e._s(r+1))]),n("td",[e._v(e._s(t.document.fields.sentence.stringValue))]),n("td",[n("edit-button",{attrs:{index:r}}),n("delete-button",{attrs:{index:r}}),n("edit-modal",{attrs:{index:r,word:t,idToken:e.idToken}})],1)])})),0)])])},oe=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("thead",[n("tr",[n("th",[e._v("ID")]),n("th",[e._v("Sentence")]),n("th",[e._v("編集・削除")])])])}],ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-modal",{attrs:{id:"bv-modal-"+e.index,title:"編集"},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var r=t.cancel,o=t.hide;return[n("b-button",{attrs:{size:"sm",variant:"outline-info"},on:{click:function(t){e.editItem(e.index),o()}}},[e._v(" 確定 ")]),n("b-button",{attrs:{size:"sm",variant:"outline-danger"},on:{click:function(e){return r()}}},[e._v(" キャンセル ")])]}}])},[n("b-input",{model:{value:e.word.document.fields.sentence.stringValue,callback:function(t){e.$set(e.word.document.fields.sentence,"stringValue",t)},expression:"word.document.fields.sentence.stringValue"}})],1)],1)},ae=[],se=(n("b0c0"),n("a9e3"),{props:{index:Number,word:Object},computed:Object(k["a"])({},Object(E["b"])(["idToken","words"])),methods:{editItem:function(e){var t=this.words[e].document.name,n={fields:{sentence:{stringValue:this.words[e].document.fields.sentence.stringValue}}};K.a.patch(t,n,{headers:{Authorization:"Bearer ".concat(this.idToken)}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}}}),ce=se,ue=Object(l["a"])(ce,ie,ae,!1,null,null,null),le=ue.exports,de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-button",{staticClass:"ml-2",attrs:{variant:"outline-danger"},on:{click:function(t){return e.deleteItem(e.index)}}},[e._v("削除")])},me=[],fe=(n("a434"),{props:{index:Number},computed:Object(k["a"])({},Object(E["b"])(["idToken","words"])),methods:{deleteItem:function(e){var t=this.words[e].document.name;console.log(t),K.a.delete(t,{headers:{Authorization:"Bearer ".concat(this.idToken)}}).then((function(e){console.log(e)})).catch((function(e){console.log(e)})),this.words.splice(e,1)}}}),pe=fe,he=Object(l["a"])(pe,de,me,!1,null,null,null),be=he.exports,ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-button",{attrs:{variant:"outline-info"},on:{click:function(t){return e.$bvModal.show("bv-modal-"+e.index)}}},[e._v("編集")])},ge=[],we={props:{index:Number}},ke=we,_e=Object(l["a"])(ke,ve,ge,!1,null,null,null),Te=_e.exports,ye={components:{EditModal:le,DeleteButton:be,EditButton:Te},computed:Object(k["a"])({},Object(E["b"])(["idToken","words"]))},xe=ye,Ie=Object(l["a"])(xe,re,oe,!1,null,null,null),je=Ie.exports,Oe={name:"Edit",components:{AddButton:F,AddModal:ne,ItemsTable:je},created:function(){this.$store.dispatch("getUserItems",this.idToken)},computed:Object(k["a"])({},Object(E["b"])(["idToken","words","currentUser"]))},Ae=Oe,Se=Object(l["a"])(Ae,R,G,!1,null,null,null),Ee=Se.exports,Ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",[n("h2",[e._v("Sing up")]),n("b-form-group",{attrs:{label:"Your email:","label-for":"input-email"}},[n("b-form-input",{attrs:{id:"input-email",required:"",placeholder:"Enter your email"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),n("b-form-group",{attrs:{label:"Password:","label-for":"input-password"}},[n("b-form-input",{attrs:{id:"input-password",type:"password",required:"",placeholder:"Enter your password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),n("b-button",{attrs:{type:"submit",variant:"primary"},on:{click:function(t){return e.register()}}},[e._v("登録")]),n("b-button",{staticClass:"ml-2",attrs:{type:"reset",variant:"danger"},on:{click:function(t){return e.reset()}}},[e._v("リセット")])],1)},$e=[],ze={name:"SignUp",data:function(){return{form:{email:"",password:""}}},methods:{register:function(){this.$store.dispatch("register",{email:this.form.email,password:this.form.password}),this.reset()},reset:function(){this.form.email="",this.form.password=""}}},Ce=ze,Me=Object(l["a"])(Ce,Ue,$e,!1,null,null,null),De=Me.exports,Le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",[n("h2",[e._v("Login")]),n("b-form-group",{attrs:{label:"Your email:","label-for":"input-email"}},[n("b-form-input",{attrs:{id:"input-email",required:"",placeholder:"Enter your email"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),n("b-form-group",{attrs:{label:"Password:","label-for":"input-password"}},[n("b-form-input",{attrs:{id:"input-password",type:"password",required:"",placeholder:"Enter your password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),n("b-button",{attrs:{type:"submit",variant:"primary"},on:{click:function(t){return e.login()}}},[e._v("ログイン")]),n("b-button",{staticClass:"ml-2",attrs:{type:"reset",variant:"danger"},on:{click:function(t){return e.reset()}}},[e._v("リセット")])],1)},We=[],qe={name:"Login",data:function(){return{form:{email:"",password:""}}},methods:{login:function(){this.$store.dispatch("login",{email:this.form.email,password:this.form.password}),this.reset()},reset:function(){this.form.email="",this.form.password=""}}},Pe=qe,Re=Object(l["a"])(Pe,Le,We,!1,null,null,null),Ge=Re.exports,Be=(n("ac1f"),n("5319"),n("96cf"),n("1da1")),Ve=K.a.create({baseURL:"https://identitytoolkit.googleapis.com/v1"}),Qe=Ve,Ne=K.a.create({baseURL:"https://securetoken.googleapis.com/v1"}),Xe=Ne,Fe=K.a.create({baseURL:"https://identitytoolkit.googleapis.com/v1"}),He=Fe;r["default"].use(E["a"]);var Ye=new E["a"].Store({state:{idToken:null,words:[],currentUser:{id:null,email:null}},getters:{idToken:function(e){return e.idToken},words:function(e){return e.words},currentUser:function(e){return e.currentUser}},mutations:{updateIdToken:function(e,t){e.idToken=t},updateWords:function(e,t){e.words=t},updateUser:function(e,t){e.currentUser=t}},actions:{autoLogin:function(e){return Object(Be["a"])(regeneratorRuntime.mark((function t(){var n,r,o,i,a,s,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.commit,r=e.dispatch,o=localStorage.getItem("idToken"),o){t.next=4;break}return t.abrupt("return");case 4:if(i=new Date,a=localStorage.getItem("expiryTimeMs"),s=localStorage.getItem("refreshToken"),c=i.getTime()>=a,!c){t.next=13;break}return t.next=11,r("refreshIdToken",s);case 11:t.next=16;break;case 13:u=a-i.getTime(),setTimeout((function(){r("refreshIdToken",s)}),u),n("updateIdToken",o);case 16:case"end":return t.stop()}}),t)})))()},login:function(e,t){var n=e.dispatch;Qe.post("/accounts:signInWithPassword?key=AIzaSyCCthIGG3XeQ-uoM6W0w9Ee1i4cjy6iWUM",{email:t.email,password:t.password,returnSecureToken:!0}).then((function(e){n("setAuthData",{idToken:e.data.idToken,expiresIn:e.data.expiresIn,refreshToken:e.data.refreshToken}),Ze.push("/")})).catch((function(e){console.log(e)}))},logout:function(e){var t=e.commit;t("updateIdToken",null),localStorage.removeItem("idToken"),localStorage.removeItem("expiryTimeMs"),localStorage.removeItem("refreshToken"),Ze.replace("/login")},refreshIdToken:function(e,t){return Object(Be["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.dispatch,n.next=3,Xe.post("/token?key=AIzaSyCCthIGG3XeQ-uoM6W0w9Ee1i4cjy6iWUM",{grant_type:"refresh_token",refresh_token:t}).then((function(e){r(" setAuthData",{idToken:e.data.idToken,expiresIn:e.data.expiresIn,refreshToken:e.data.refreshToken})}));case 3:case"end":return n.stop()}}),n)})))()},register:function(e,t){var n=e.dispatch;Qe.post("/accounts:signUp?key=AIzaSyCCthIGG3XeQ-uoM6W0w9Ee1i4cjy6iWUM",{email:t.email,password:t.password,returnSecureToken:!0}).then((function(e){n("setAuthData",{idToken:e.data.id_token,expiresIn:e.data.expires_in,refreshToken:e.data.refresh_token}),Ze.push("/")})).catch((function(e){console.log(e)}))},setAuthData:function(e,t){var n=this,r=e.commit,o=e.dispatch,i=new Date,a=i.getTime()+1e3*t.expiresIn;r("updateIdToken",t.idToken),localStorage.setItem("idToken",t.idToken),localStorage.setItem("expiryTimeMs",a),localStorage.setItem("refreshToken",t.refreshToken),setTimeout((function(){o("refreshIdToken",t.refreshIdToken),n.refreshIdToken()}),1e3*t.expiresIn)},getUserData:function(e,t){return Object(Be["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.commit,n.next=3,He.post("/accounts:lookup?key=AIzaSyCCthIGG3XeQ-uoM6W0w9Ee1i4cjy6iWUM",{idToken:t}).then((function(e){var t={id:e.data.users[0].localId,email:e.data.users[0].email};r("updateUser",t)})).catch((function(e){console.log(e)}));case 3:case"end":return n.stop()}}),n)})))()},getAllData:function(e,t){var n=e.commit,r=e.getters;K.a.post("projects/typing-app-f08b8/databases/(default)/documents:runQuery",{structuredQuery:{from:[{collectionId:"words"}],select:{fields:[{fieldPath:"sentence"}]},where:{fieldFilter:{field:{fieldPath:"userId"},op:"EQUAL",value:{stringValue:r.currentUser.id}}}}},{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){for(var t=0;t<=e.data.length;t++)n("updateWords",e.data)})).catch((function(e){console.log(e)}))},getUserItems:function(e,t){return Object(Be["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.dispatch,n.next=3,r("getUserData",t);case 3:r("getAllData",t);case 4:case"end":return n.stop()}}),n)})))()}},modules:{}});r["default"].use(v["a"]);var Je=[{path:"/",name:"Home",component:C,beforeEnter:function(e,t,n){Ye.getters.idToken?n():n("/login")}},{path:"/about",name:"About",component:P},{path:"/edit",name:"Edit",component:Ee},{path:"/signup",name:"SignUp",component:De,beforeEnter:function(e,t,n){Ye.getters.idToken?n("/"):n()}},{path:"/login",name:"Login",component:Ge,beforeEnter:function(e,t,n){Ye.getters.idToken?n("/"):n()}}],Ke=new v["a"]({mode:"history",base:"",routes:Je}),Ze=Ke,et=n("5f5b"),tt=n("b1e0");n("f9e3"),n("2dd8");r["default"].use(et["a"]),r["default"].use(tt["a"]),r["default"].config.productionTip=!1,K.a.defaults.baseURL="https://firestore.googleapis.com/v1/",Ye.dispatch("autoLogin").then((function(){new r["default"]({router:Ze,store:Ye,render:function(e){return e(b)}}).$mount("#app")}))},"589e":function(e,t,n){},"5c0b":function(e,t,n){"use strict";var r=n("9c0c"),o=n.n(r);o.a},"71eb":function(e,t,n){"use strict";var r=n("756b"),o=n.n(r);o.a},"756b":function(e,t,n){},"9c0c":function(e,t,n){},b047:function(e,t,n){"use strict";var r=n("589e"),o=n.n(r);o.a},cf05:function(e,t,n){e.exports=n.p+"img/logo.82b9c7a5.png"}});
//# sourceMappingURL=app.185ebada.js.map